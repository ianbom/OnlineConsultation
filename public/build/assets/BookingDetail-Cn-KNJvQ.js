import{j as e,L as g,r as b,a as M}from"./app-AVjLOvBt.js";import{c as C,e as v,C as p,f as w,u as A,A as R,a as L,b as P,P as $}from"./PageLayout-DQy80rI4.js";import{C as a,c as t,a as _,b as k}from"./card-B9Fmb9RI.js";import{B as c}from"./button-OdaSFC08.js";import{B as S}from"./badge-D8biGA4b.js";import{C as f}from"./clock-BC5b9NMD.js";import{C as K}from"./circle-alert-DQe2aGhq.js";import{S as y}from"./separator-M-C1YhqY.js";import{f as U}from"./format-DKbtvHO8.js";import{C as E}from"./credit-card-Q35kIMx9.js";import{i as I}from"./id-BLZN8RMz.js";import{C as z}from"./chevron-left-B-wDIEYk.js";import"./index-pVWQ27oQ.js";const J=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],F=C("copy",J);const q=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],H=C("external-link",q);function V({booking:s}){const{toast:r}=A(),[l,m]=b.useState(!1),j=()=>{navigator.clipboard.writeText(s.payment?.payment_url??""),m(!0),r({title:"Link disalin",description:"Link pembayaran berhasil disalin ke clipboard"}),setTimeout(()=>m(!1),2e3)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{className:"border-warning/30 bg-warning/5",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3 w-full",children:[e.jsx(K,{className:"h-5 w-5 text-warning mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[" ",e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Menunggu Pembayaran"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3 break-words",children:"Silakan selesaikan pembayaran untuk mengonfirmasi booking Anda. Booking akan otomatis dibatalkan jika pembayaran tidak diselesaikan dalam 15 menit."}),e.jsxs("div",{className:"flex items-center gap-2 mb-3 w-full",children:[e.jsx("div",{className:`flex-1 bg-background rounded-lg p-3 text-sm font-mono
                    text-muted-foreground truncate max-w-full overflow-hidden`,children:s.payment?.payment_url}),e.jsx(c,{variant:"outline",size:"icon",onClick:j,children:l?e.jsx(w,{className:"h-4 w-4 text-success"}):e.jsx(F,{className:"h-4 w-4"})}),e.jsx(c,{variant:"outline",size:"icon",asChild:!0,children:e.jsx("a",{href:s.payment?.payment_url??"",target:"_blank",rel:"noopener noreferrer",children:e.jsx(H,{className:"h-4 w-4"})})})]})]})]})})}),e.jsx("div",{className:"space-y-2",children:e.jsx(c,{className:"w-full",size:"lg",variant:"default",asChild:!0,children:e.jsx("a",{href:s.payment?.payment_url??"",target:"_blank",rel:"noopener noreferrer",children:"Bayar Sekarang"})})})]})}function W({booking:s}){const r=new Date(s.schedule.date),l=new Date,m=r<l,i=(new Date(`${s.schedule.date}T${s.schedule.start_time}`).getTime()-l.getTime())/(1e3*60*60),x=i<2&&i>0,u=s.status==="paid"&&!s.is_expired&&s.reschedule_status==="none"&&i>=2,h=d=>d.charAt(0).toUpperCase()+d.slice(1);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{className:"border-success/30 bg-success/5",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(w,{className:"h-5 w-5 text-success mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Pembayaran Berhasil"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Booking Anda telah dikonfirmasi. Silahkan datang sesuai jadwal yang telah dipesan."})]})]})})}),s.reschedule_status!=="none"&&e.jsx(a,{className:"border-primary/20 bg-primary/5",children:e.jsxs(t,{className:"p-4 space-y-3",children:[e.jsx("h4",{className:"font-semibold text-foreground",children:"Status Reschedule"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold
                ${s.reschedule_status==="pending"?"bg-yellow-100 text-yellow-800":s.reschedule_status==="approved"?"bg-green-100 text-green-800":s.reschedule_status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-700"}`,children:h(s.reschedule_status??"")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Diminta oleh"}),e.jsx("span",{className:"font-medium",children:s.reschedule_by?h(s.reschedule_by):"-"})]}),s.reschedule_reason&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:"Alasan Reschedule"}),e.jsx("p",{className:"text-sm font-medium mt-1",children:s.reschedule_reason})]}),s.reschedule_status==="pending"&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 p-3 rounded-md text-xs",children:"Permintaan reschedule sedang menunggu persetujuan konselor."}),s.reschedule_status==="approved"&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 p-3 rounded-md text-xs",children:"Reschedule disetujui. Silakan cek jadwal terbaru Anda."}),s.reschedule_status==="rejected"&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 p-3 rounded-md text-xs",children:"Reschedule ditolak. Jadwal tetap menggunakan sesi sebelumnya."})]})}),x&&s.reschedule_status==="none"&&e.jsx(a,{className:"border-orange-300 bg-orange-50",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(f,{className:"h-5 w-5 text-orange-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Reschedule Tidak Tersedia"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Reschedule hanya dapat dilakukan minimal 2 jam sebelum sesi dimulai. Silakan hubungi konselor jika ada kendala."})]})]})})}),u&&e.jsx(a,{className:"border-primary/20 bg-primary/5",children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:e.jsx(p,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Perlu Mengubah Jadwal?"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Anda dapat melakukan reschedule sesi konseling ini jika ada perubahan jadwal. Reschedule hanya dapat dilakukan minimal 2 jam sebelum sesi."}),e.jsx(c,{asChild:!0,children:e.jsxs(g,{href:route("client.pick.reschedule",s.id),children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Reschedule Booking"]})})]})]})})}),s.consultation_type==="online"&&e.jsx(e.Fragment,{children:s.meeting_link?e.jsx(a,{className:"border-primary/30 bg-primary/5",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(p,{className:"h-5 w-5 text-primary mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Link Konsultasi Tersedia"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Link meeting sudah siap. Anda dapat masuk ke ruang konsultasi sekarang."}),e.jsx(c,{className:"w-full",asChild:!0,children:e.jsx("a",{href:s.meeting_link,target:"_blank",rel:"noopener noreferrer",children:"Masuk ke Sesi Konsultasi"})})]})]})})}):!m&&e.jsx(a,{className:"border-muted",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(f,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Menunggu Link Meeting"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Konselor akan mengirimkan link sebelum sesi dimulai."})]})]})})})})]})}function X({booking:s}){const r=s.cancelled_by==="client"?"Dibatalkan oleh Anda":s.cancelled_by==="counselor"?"Dibatalkan oleh Konselor":s.cancelled_by==="admin"?"Dibatalkan oleh Admin":"Dibatalkan oleh Sistem";return e.jsx("div",{className:"space-y-4",children:e.jsx(a,{className:"border-destructive/30 bg-destructive/5",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(v,{className:"h-5 w-5 text-destructive mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Booking Dibatalkan"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:r}),s.cancel_reason&&e.jsxs("p",{className:"text-sm text-muted-foreground italic bg-background p-2 rounded-lg",children:["Alasan: ",s.cancel_reason]}),s.payment?.status==="refund"&&e.jsx("p",{className:"text-sm text-blue-600 mt-3",children:"Dana sedang dalam proses pengembalian (refund)."}),s.payment?.status==="refunded"&&e.jsx("p",{className:"text-sm text-green-600 mt-3 font-medium",children:"Dana telah berhasil dikembalikan."})]})]})})})})}function G({booking:s}){return e.jsx("div",{className:"space-y-4",children:e.jsx(a,{className:"border-orange-300 bg-orange-50",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(f,{className:"h-5 w-5 text-orange-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Pembayaran Kadaluarsa"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Waktu pembayaran telah berakhir. Booking dibatalkan otomatis oleh sistem."}),s.cancel_reason&&e.jsxs("p",{className:"text-sm italic text-muted-foreground bg-background p-2 rounded-lg",children:["Alasan: ",s.cancel_reason]})]})]})})})})}function O({booking:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{className:"border-primary/30 bg-primary/5",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(w,{className:"h-5 w-5 text-primary mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Sesi Konsultasi Selesai"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Terima kasih telah menggunakan layanan kami. Kami harap sesi konsultasi bermanfaat untuk Anda."})]})]})})}),s.counselor_notes&&e.jsxs(a,{className:"border-border bg-background",children:[e.jsx(_,{children:e.jsx(k,{className:"text-lg",children:"Catatan Konselor"})}),e.jsx(t,{children:e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed whitespace-pre-line",children:s.counselor_notes})})]})]})}function Q({booking:s}){const r=s.previous_schedule,l=s.previous_second_schedule,m=new Date,i=(new Date(`${s.schedule.date}T${s.schedule.start_time}`).getTime()-m.getTime())/(1e3*60*60),x=i<2&&i>0,u=i>=2;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{className:"border-warning/30 bg-warning/5",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(p,{className:"h-5 w-5 text-warning mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Jadwal Diubah"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Booking ini telah dijadwalkan ulang. (Perubahan jadwal masih menunggu persetujuan Konselor)"}),r&&e.jsxs("div",{className:"bg-background rounded-lg p-3 text-sm space-y-1 border",children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Jadwal Sebelumnya:"}),e.jsx("p",{className:"font-medium text-foreground",children:r.date}),e.jsxs("p",{className:"text-muted-foreground",children:[r.start_time.substring(0,5)," -"," ",r.end_time.substring(0,5)]}),l&&e.jsxs("p",{className:"text-muted-foreground",children:["& ",l.start_time.substring(0,5)," -"," ",l.end_time.substring(0,5)]})]})]})]})})}),x&&e.jsx(a,{className:"border-orange-300 bg-orange-50",children:e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(f,{className:"h-5 w-5 text-orange-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Reschedule & Pembatalan Tidak Tersedia"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Reschedule dan pembatalan hanya dapat dilakukan minimal 2 jam sebelum sesi dimulai. Silakan hubungi konselor jika ada kendala."})]})]})})}),u&&s.reschedule_status==="approved"&&e.jsx(a,{className:"border-primary/20 bg-primary/5",children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:e.jsx(p,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Perlu Mengubah Jadwal Lagi?"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Anda dapat melakukan reschedule ulang jika diperlukan. Reschedule hanya dapat dilakukan minimal 2 jam sebelum sesi."}),e.jsx(c,{asChild:!0,children:e.jsxs(g,{href:route("client.pick.reschedule",s.id),children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Reschedule Ulang"]})})]})]})})}),u&&s.reschedule_status==="approved"&&e.jsx(a,{className:"border-destructive/20 bg-destructive/5",children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-destructive/10",children:e.jsx(v,{className:"h-6 w-6 text-destructive"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Perlu Membatalkan Booking?"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Pembatalan hanya dapat dilakukan minimal 2 jam sebelum sesi dimulai. Dana akan dikembalikan sesuai kebijakan refund."}),e.jsx(c,{variant:"destructive",asChild:!0,children:e.jsxs(g,{href:route("client.booking.cancel",s.id),children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Batalkan Booking"]})})]})]})})}),s.meeting_link&&e.jsx(c,{className:"w-full",size:"lg",asChild:!0,children:e.jsx("a",{href:s.meeting_link,target:"_blank",rel:"noopener noreferrer",children:"Masuk ke Sesi Konsultasi"})})]})}function Y({booking:s}){const l=s.counselor.user.profile_pic?`http://127.0.0.1:8000/storage/${s.counselor.user.profile_pic}`:"/default-avatar.png",m=new Date(s.schedule.date),j=s.schedule.start_time.substring(0,5),i=s.second_schedule?.end_time?.substring(0,5)||s.schedule.end_time.substring(0,5),x=`${j} - ${i}`,u=s.payment?.amount??0,h=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(n),d=n=>n.replace(/_/g," ").split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");return e.jsxs(a,{className:"mb-6",children:[e.jsx(_,{className:"pb-4",children:e.jsxs(k,{className:"text-lg",children:["Invoice #",s.payment?.order_id]})}),e.jsxs(t,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[e.jsxs(R,{className:"h-16 w-16 rounded-lg mx-auto sm:mx-0",children:[e.jsx(L,{src:l,alt:s.counselor.user.name}),e.jsx(P,{className:"rounded-lg",children:s.counselor.user.name.split(" ").map(n=>n[0]).join("")})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"font-semibold text-foreground text-lg",children:s.counselor.user.name}),e.jsx("div",{className:"flex flex-wrap justify-center sm:justify-start gap-1 mt-1",children:s.counselor.specialization?.split(",").map((n,o)=>e.jsx(S,{variant:"secondary",className:"text-xs",children:n.trim()},o))})]})]}),e.jsx(y,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{icon:e.jsx(p,{className:"h-4 w-4"}),label:"Tanggal",value:U(m,"EEEE, d MMMM yyyy",{locale:I})}),e.jsx(N,{icon:e.jsx(f,{className:"h-4 w-4"}),label:"Waktu",value:x}),e.jsx(N,{icon:e.jsx(f,{className:"h-4 w-4"}),label:"Durasi",value:`${s.duration_hours} jam`}),e.jsx(N,{icon:e.jsx(E,{className:"h-4 w-4"}),label:"Metode Pembayaran",value:d(s.payment?.payment_type??"Belum")}),e.jsx(N,{icon:e.jsx(p,{className:"h-4 w-4"}),label:"Jenis Konsultasi",value:s.consultation_type})]}),e.jsx(y,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Biaya Sesi"}),e.jsx("span",{children:h(s.price)})]}),e.jsx(y,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Total"}),e.jsx("span",{className:"text-xl font-semibold",children:h(u)})]})]})]})]})}function N({icon:s,label:r,value:l}){return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s,e.jsx("span",{children:r})]}),e.jsx("span",{className:"font-medium text-foreground break-words",children:l})]})}function xe({booking:s}){s.counselor.user.profile_pic&&`http://127.0.0.1:8000${s.counselor.user.profile_pic}`;const l=d=>({pending_payment:"warning",paid:"success",completed:"default",cancelled:"destructive",rescheduled:"secondary"})[d]||"secondary",m=d=>d.replace(/_/g," ").split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" "),j=()=>{if(s.is_expired)return e.jsx(G,{booking:s});if(s.status==="cancelled")return e.jsx(X,{booking:s});switch(s.status){case"pending_payment":return e.jsx(V,{booking:s});case"paid":return e.jsx(W,{booking:s});case"completed":return e.jsx(O,{booking:s});case"rescheduled":return e.jsx(Q,{booking:s});default:return null}},i=()=>{confirm("Anda yakin ingin membatalkan booking ini?")&&M.post(route("client.cancel.booking",s.id),{reason:"Dibatalkan oleh client"},{preserveScroll:!0})},x=s.payment?.expiry_time?new Date(s.payment.expiry_time):null,[u,h]=b.useState(null);return b.useEffect(()=>{if(!x)return;const d=setInterval(()=>{const n=new Date().getTime(),o=x.getTime()-n;if(o<=0){h("Kadaluarsa"),clearInterval(d);return}const D=Math.floor(o/(1e3*60*60)),T=Math.floor(o%(1e3*60*60)/(1e3*60)),B=Math.floor(o%(1e3*60)/1e3);h(`${D}j ${T}m ${B}d`)},1e3);return()=>clearInterval(d)},[x]),e.jsx($,{children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsx(c,{variant:"ghost",asChild:!0,className:"mb-4",children:e.jsxs(g,{href:route("client.booking.history"),children:[e.jsx(z,{className:"h-4 w-4 mr-1"}),"Kembali ke Daftar Booking"]})}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"font-display text-2xl font-semibold text-foreground",children:"Detail Booking"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(S,{variant:l(s.status),className:"text-sm",children:m(s.status)}),u&&!s.is_expired&&s.status=="pending_payment"&&e.jsx("div",{className:"px-3 py-1 rounded-md bg-red-50 border border-red-200 text-red-600 text-xs font-medium",children:u==="Kadaluarsa"?"Kadaluarsa":`Sisa waktu: ${u}`}),["paid","rescheduled"].includes(s.status)&&!s.is_expired&&e.jsx(c,{variant:"destructive",size:"sm",onClick:()=>i(),children:"Cancel Booking"})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(Y,{booking:s})}),e.jsxs("div",{className:"h-fit",children:[j(),s.notes&&e.jsxs(a,{className:"my-3",children:[e.jsx(_,{children:e.jsx(k,{className:"text-lg",children:"Catatan Klien"})}),e.jsx(t,{children:e.jsx("p",{className:"text-muted-foreground",children:s.notes})})]}),e.jsx(c,{variant:"outline",className:"w-full my-2 bg-amber-50 border-primary transition hover:bg-primary hover:border-white hover:text-white",asChild:!0,children:e.jsx(g,{href:route("client.booking.history"),children:"Lihat Semua Booking"})})]})]})})]})})}export{xe as default};
