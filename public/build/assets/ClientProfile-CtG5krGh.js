import{r as o,j as e,a as A}from"./app-Cphvz44M.js";import{c as N,u as _,P as D,A as E,a as T,b as I,C as L,e as B,f as K,M as R}from"./PageLayout-DDXYa8m8.js";import{C as m,c as p,a as h,b as x}from"./card-DH1y5Idi.js";import{B as U}from"./button-LSwK0d_m.js";import{I as c}from"./input-bXR82L8S.js";import{L as d}from"./label-DpORI0w2.js";import{f as z}from"./format-DKbtvHO8.js";import"./index-DS3aEpLL.js";const H=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],$=N("camera",H);const O=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],V=N("lock",O);function ee({user:s}){const{toast:n}=_(),f=o.useRef(null),[u,j]=o.useState(!1),[y,b]=o.useState(s.profile_pic?`/storage/${s.profile_pic}`:null),[g,w]=o.useState(null),[r,v]=o.useState({name:s.name,email:s.email,phone:s.phone||"",password:"",confirmPassword:""}),l=t=>{v(a=>({...a,[t.target.name]:t.target.value}))},k=()=>{f.current?.click()},P=t=>{const a=t.target.files?.[0];if(a){if(!a.type.startsWith("image/")){n({title:"Error",description:"File harus berupa gambar.",variant:"destructive"});return}if(a.size>2*1024*1024){n({title:"Error",description:"Ukuran file maksimal 2MB.",variant:"destructive"});return}w(a);const i=new FileReader;i.onloadend=()=>{b(i.result)},i.readAsDataURL(a)}},C=t=>{if(t.preventDefault(),r.password&&r.password!==r.confirmPassword){n({title:"Error",description:"Password tidak cocok.",variant:"destructive"});return}j(!0);const a=new FormData;a.append("name",r.name||s.name),a.append("email",r.email||s.email),a.append("phone",r.phone||s.phone||""),g&&a.append("profile_pic",g),r.password&&r.password.trim()!==""&&(a.append("password",r.password),a.append("password_confirmation",r.confirmPassword)),a.append("_method","POST"),A.post(route("client.profile.update"),a,{forceFormData:!0,onSuccess:()=>{n({title:"Berhasil",description:"Profil Anda berhasil diperbarui."}),v(i=>({...i,password:"",confirmPassword:""})),w(null)},onError:i=>{const F=Object.values(i).flat().join(", ")||"Gagal memperbarui profil. Silakan periksa input Anda.";n({title:"Error",description:F,variant:"destructive"})},onFinish:()=>{j(!1)}})},M=t=>t.split(" ").map(a=>a[0]).join("").toUpperCase(),S=()=>{const t=new Date(s.created_at),i=Math.floor((new Date().getTime()-t.getTime())/(1e3*60*60*24*30));return i>0?`${i} bulan`:"Kurang dari sebulan"};return e.jsx(D,{title:"Profil Saya",description:"Kelola pengaturan akun dan preferensi Anda",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(m,{children:e.jsxs(p,{className:"p-6 text-center",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsxs(E,{className:"h-24 w-24 mx-auto border-4 border-primary/10",children:[e.jsx(T,{src:y||void 0,alt:s.name}),e.jsx(I,{className:"text-2xl",children:M(s.name)})]}),e.jsx("button",{type:"button",onClick:k,className:"absolute bottom-0 right-0 h-8 w-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center shadow-md hover:bg-primary/90 transition-colors",children:e.jsx($,{className:"h-4 w-4"})}),e.jsx("input",{ref:f,type:"file",accept:"image/*",onChange:P,className:"hidden"})]}),e.jsx("h2",{className:"font-display text-xl font-semibold text-foreground mt-4",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email}),e.jsxs("div",{className:"flex items-center justify-center gap-1 mt-2 text-sm text-muted-foreground",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{children:["Sejak ",z(new Date(s.created_at),"MMMM yyyy")]})]})]})}),e.jsxs(m,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(x,{className:"text-base",children:"Statistik Cepat"})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status Email"}),e.jsx("span",{className:"font-medium text-foreground",children:s.email_verified_at?"Terverifikasi":"Belum Terverifikasi"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Aktif Sejak"}),e.jsx("span",{className:"font-medium text-foreground",children:S()})]})]})]})]}),e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(x,{className:"text-lg flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-primary"}),"Informasi Pribadi"]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"name",children:"Nama Lengkap"}),e.jsx(c,{id:"name",name:"name",value:r.name,onChange:l,placeholder:"Masukkan nama Anda"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"phone",children:"Nomor Telepon"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(c,{id:"phone",name:"phone",value:r.phone,onChange:l,placeholder:"Masukkan nomor telepon",className:"pl-10"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Alamat Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(c,{id:"email",name:"email",type:"email",value:r.email,onChange:l,placeholder:"Masukkan alamat email",className:"pl-10"})]})]})]})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(x,{className:"text-lg flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-primary"}),"Ubah Password"]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"password",children:"Password Baru"}),e.jsx(c,{id:"password",name:"password",type:"password",value:r.password,onChange:l,placeholder:"Masukkan password baru"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"confirmPassword",children:"Konfirmasi Password"}),e.jsx(c,{id:"confirmPassword",name:"confirmPassword",type:"password",value:r.confirmPassword,onChange:l,placeholder:"Konfirmasi password baru"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Kosongkan jika tidak ingin mengubah password"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(U,{size:"lg",onClick:C,disabled:u,children:u?"Menyimpan...":"Simpan Perubahan"})})]})]})})})}export{ee as default};
