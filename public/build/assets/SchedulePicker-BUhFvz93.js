import{j as e,r as d,L as P,a as L}from"./app-BSu0ofF2.js";import{A as M,a as I,b as O,P as A,d as R}from"./PageLayout-D__ctkwN.js";import{B as j}from"./button-BRyfCJ_Y.js";import{a as f,C as W,b as T,T as B}from"./TimeSlots-E3bGVPXB.js";import{C as E,c as z}from"./card-CHdoWMUd.js";import{s as K,f as h}from"./format-DKbtvHO8.js";import{C as F}from"./chevron-left-Ci-HB2sw.js";import"./index-DW7OYsA0.js";import"./clock-mjsBM3EN.js";function G({counselor:s}){const l=s.user.profile_pic?`/storage/${s.user.profile_pic}`:null;return e.jsx(E,{className:"mb-6",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(M,{className:"h-14 w-14 rounded-lg",children:[e.jsx(I,{src:l||void 0,alt:s.user.name}),e.jsx(O,{className:"rounded-lg",children:s.user.name.split(" ").map(c=>c[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-foreground",children:s.user.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Offline: Rp"," ",s.price_per_session.toLocaleString("id-ID")," ","/ Online: Rp"," ",s.online_price_per_session.toLocaleString("id-ID")]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Pilih 1–2 jam konseling yang berdampingan"})]})]})})})}function Z({counselor:s}){const[l,c]=d.useState(K(new Date,{weekStartsOn:1})),[o,x]=d.useState(null),[a,m]=d.useState([]),S=Array.from({length:7},(t,i)=>f(l,i)),N=d.useMemo(()=>{const t={};return s.schedules.forEach(i=>{if(i.is_available){const n=h(new Date(i.date),"yyyy-MM-dd");t[n]||(t[n]=[]),t[n].push(i)}}),t},[s.schedules]),u=t=>{const i=h(t,"yyyy-MM-dd");return(N[i]||[]).map(r=>({id:r.id,time:r.start_time.substring(0,5),startTime:r.start_time,endTime:r.end_time,isBooked:!1})).sort((r,p)=>r.time.localeCompare(p.time))},y=(t,i)=>{const[n]=t.split(":").map(Number),[r]=i.split(":").map(Number);return Math.abs(n-r)===1},g=t=>a.length===0?!0:a.length===1?y(a[0].time,t.time):!1,v=()=>{c(f(l,-7)),x(null),m([])},b=()=>{c(f(l,7)),x(null),m([])},w=t=>{x(t),m([])},_=t=>{if(a.some(n=>n.id===t.id))m(a.filter(n=>n.id!==t.id));else if(g(t)){const n=[...a,t].sort((r,p)=>r.time.localeCompare(p.time));m(n)}},k=()=>{if(a.length>0){const t=a.map(i=>i.id).join(",");L.visit(route("client.process.payment",{counselorId:s.id,scheduleIds:t}))}},C=s.price_per_session*a.length,D=s.online_price_per_session*a.length;return e.jsx(A,{children:e.jsxs("div",{className:"mx-auto max-w-3xl",children:[e.jsx(j,{variant:"ghost",asChild:!0,className:"mb-4",children:e.jsxs(P,{href:route("client.counselor.show",s.id),children:[e.jsx(F,{className:"mr-1 h-4 w-4"}),"Kembali ke Profil"]})}),e.jsx(G,{counselor:s}),e.jsx(W,{weekStart:l,onPrevWeek:v,onNextWeek:b}),e.jsx(T,{weekDays:S,selectedDate:o,onSelectDate:w,getAvailableSlots:u}),o&&e.jsx(B,{selectedDate:o,availableSlots:u(o),selectedSlots:a,canSelectSlot:g,onSelectSlot:_}),o&&a.length>0&&e.jsx("div",{className:"animate-slide-up fixed bottom-0 left-0 right-0 z-50 border-t bg-card p-4 shadow-lg",children:e.jsxs("div",{className:"mx-auto flex max-w-3xl flex-col items-start justify-between gap-3 sm:flex-row sm:items-center sm:gap-0",children:[e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Terpilih"}),e.jsxs("p",{className:"font-medium text-foreground",children:[h(o,"d MMM yyyy")," •"," ",a.map(t=>t.time).join(", ")]}),e.jsxs("div",{className:"mt-1 space-y-0.5",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Offline: Rp"," ",C.toLocaleString("id-ID")," (",a.length," sesi)"]}),e.jsxs("p",{className:"text-sm text-green-600",children:["Online: Rp"," ",D.toLocaleString("id-ID")," (",a.length," sesi)"]})]})]}),e.jsxs(j,{size:"lg",onClick:k,className:"flex w-full items-center justify-center text-center sm:w-auto",children:["Lanjutkan Pemesanan",e.jsx(R,{className:"ml-1 h-4 w-4"})]})]})})]})})}export{Z as default};
