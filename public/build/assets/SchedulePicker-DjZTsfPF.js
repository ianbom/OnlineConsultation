import{j as e,r as c,L as k,a as _}from"./app-D-Qq1QI6.js";import{C as D,c as P,A,d as L,e as M,P as I,B as h,h as T}from"./card-B3HMtUXs.js";import{a as u,C as B,b as R,T as W}from"./CalendarHeader-TwtleNcz.js";import{s as E,f as j}from"./format-DKbtvHO8.js";import{C as z}from"./chevron-left-BaK8p1_y.js";import"./index-Ci9urwJV.js";import"./clock-Dn0S3fUi.js";function K({counselor:s}){const o=s.user.profile_pic?`/storage/${s.user.profile_pic}`:null;return e.jsx(D,{className:"mb-6",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(A,{className:"h-14 w-14 rounded-lg",children:[e.jsx(L,{src:o||void 0,alt:s.user.name}),e.jsx(M,{className:"rounded-lg",children:s.user.name.split(" ").map(m=>m[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-foreground",children:s.user.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Rp ",s.price_per_session.toLocaleString("id-ID")," per sesi"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Pilih 1–2 jam konseling yang berdampingan"})]})]})})})}function J({counselor:s}){const[o,m]=c.useState(E(new Date,{weekStartsOn:1})),[l,g]=c.useState(null),[a,d]=c.useState([]),S=Array.from({length:7},(t,r)=>u(o,r)),N=c.useMemo(()=>{const t={};return s.schedules.forEach(r=>{if(r.is_available===1){const i=r.date;t[i]||(t[i]=[]),t[i].push(r)}}),t},[s.schedules]),x=t=>{const r=j(t,"yyyy-MM-dd");return(N[r]||[]).map(n=>({id:n.id,time:n.start_time.substring(0,5),startTime:n.start_time,endTime:n.end_time,isBooked:!1})).sort((n,p)=>n.time.localeCompare(p.time))},b=(t,r)=>{const[i]=t.split(":").map(Number),[n]=r.split(":").map(Number);return Math.abs(i-n)===1},f=t=>a.length===0?!0:a.length===1?b(a[0].time,t.time):!1,v=t=>{g(t),d([])},w=t=>{if(a.some(i=>i.id===t.id))d(a.filter(i=>i.id!==t.id));else if(f(t)){const i=[...a,t].sort((n,p)=>n.time.localeCompare(p.time));d(i)}},y=()=>{if(a.length>0){const t=a.map(r=>r.id).join(",");_.visit(route("client.process.payment",{counselorId:s.id,scheduleIds:t}))}};l&&x(l),s.user.profile_pic&&`${s.user.profile_pic}`;const C=s.price_per_session*a.length;return e.jsx(I,{children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(h,{variant:"ghost",asChild:!0,className:"mb-4",children:e.jsxs(k,{href:route("client.counselor.show",s.id),children:[e.jsx(z,{className:"h-4 w-4 mr-1"}),"Kembali ke Profil"]})}),e.jsx(K,{counselor:s}),e.jsx(B,{weekStart:o,onPrevWeek:()=>m(u(o,-7)),onNextWeek:()=>m(u(o,7))}),e.jsx(R,{weekDays:S,selectedDate:l,onSelectDate:v,getAvailableSlots:x}),l&&e.jsx(W,{selectedDate:l,availableSlots:x(l),selectedSlots:a,canSelectSlot:f,onSelectSlot:w}),l&&a.length>0&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-card border-t shadow-lg animate-slide-up z-50",children:e.jsxs("div",{className:`
                max-w-3xl mx-auto
                flex flex-col sm:flex-row
                items-start sm:items-center
                gap-3 sm:gap-0
                justify-between
              `,children:[e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Terpilih"}),e.jsxs("p",{className:"font-medium text-foreground",children:[j(l,"d MMM yyyy")," • ",a.map(t=>t.time).join(", ")]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Total: Rp ",C.toLocaleString("id-ID")," (",a.length," sesi)"]})]}),e.jsxs(h,{size:"lg",onClick:y,className:`
                  w-full sm:w-auto
                  text-center
                  flex items-center justify-center
                `,children:["Lanjutkan Pemesanan",e.jsx(T,{className:"h-4 w-4 ml-1"})]})]})})]})})}export{J as default};
