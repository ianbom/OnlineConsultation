import{j as e,r as c,L as k,a as D}from"./app-ipf8GeFS.js";import{A as P,a as L,b as I,P as O,d as A}from"./PageLayout-efhwup8l.js";import{B as u}from"./button-CKO8849o.js";import{a as x,C as M,b as R,T}from"./TimeSlots-BFgckrWL.js";import{C as B,c as W}from"./card-BbVtej2Z.js";import{s as E,f as g}from"./format-DKbtvHO8.js";import{C as z}from"./chevron-left-Dl_Ao-4g.js";import"./index-DW7OYsA0.js";import"./clock-DzzWEMKx.js";function K({counselor:s}){const o=s.user.profile_pic?`/storage/${s.user.profile_pic}`:null;return e.jsx(B,{className:"mb-6",children:e.jsx(W,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(P,{className:"h-14 w-14 rounded-lg",children:[e.jsx(L,{src:o||void 0,alt:s.user.name}),e.jsx(I,{className:"rounded-lg",children:s.user.name.split(" ").map(m=>m[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-foreground",children:s.user.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Offline: Rp"," ",s.price_per_session.toLocaleString("id-ID")," ","/ Online: Rp"," ",s.online_price_per_session.toLocaleString("id-ID")]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Pilih 1–2 jam konseling yang berdampingan"})]})]})})})}function X({counselor:s}){const[o,m]=c.useState(E(new Date,{weekStartsOn:1})),[l,j]=c.useState(null),[a,d]=c.useState([]),S=Array.from({length:7},(t,i)=>x(o,i)),N=c.useMemo(()=>{const t={};return s.schedules.forEach(i=>{if(i.is_available===1){const r=i.date;t[r]||(t[r]=[]),t[r].push(i)}}),t},[s.schedules]),p=t=>{const i=g(t,"yyyy-MM-dd");return(N[i]||[]).map(n=>({id:n.id,time:n.start_time.substring(0,5),startTime:n.start_time,endTime:n.end_time,isBooked:!1})).sort((n,f)=>n.time.localeCompare(f.time))},_=(t,i)=>{const[r]=t.split(":").map(Number),[n]=i.split(":").map(Number);return Math.abs(r-n)===1},h=t=>a.length===0?!0:a.length===1?_(a[0].time,t.time):!1,b=t=>{j(t),d([])},v=t=>{if(a.some(r=>r.id===t.id))d(a.filter(r=>r.id!==t.id));else if(h(t)){const r=[...a,t].sort((n,f)=>n.time.localeCompare(f.time));d(r)}},y=()=>{if(a.length>0){const t=a.map(i=>i.id).join(",");D.visit(route("client.process.payment",{counselorId:s.id,scheduleIds:t}))}};l&&p(l),s.user.profile_pic&&`${s.user.profile_pic}`;const w=s.price_per_session*a.length,C=s.online_price_per_session*a.length;return e.jsx(O,{children:e.jsxs("div",{className:"mx-auto max-w-3xl",children:[e.jsx(u,{variant:"ghost",asChild:!0,className:"mb-4",children:e.jsxs(k,{href:route("client.counselor.show",s.id),children:[e.jsx(z,{className:"mr-1 h-4 w-4"}),"Kembali ke Profil"]})}),e.jsx(K,{counselor:s}),e.jsx(M,{weekStart:o,onPrevWeek:()=>m(x(o,-7)),onNextWeek:()=>m(x(o,7))}),e.jsx(R,{weekDays:S,selectedDate:l,onSelectDate:b,getAvailableSlots:p}),l&&e.jsx(T,{selectedDate:l,availableSlots:p(l),selectedSlots:a,canSelectSlot:h,onSelectSlot:v}),l&&a.length>0&&e.jsx("div",{className:"animate-slide-up fixed bottom-0 left-0 right-0 z-50 border-t bg-card p-4 shadow-lg",children:e.jsxs("div",{className:"mx-auto flex max-w-3xl flex-col items-start justify-between gap-3 sm:flex-row sm:items-center sm:gap-0",children:[e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Terpilih"}),e.jsxs("p",{className:"font-medium text-foreground",children:[g(l,"d MMM yyyy")," •"," ",a.map(t=>t.time).join(", ")]}),e.jsxs("div",{className:"mt-1 space-y-0.5",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Offline: Rp"," ",w.toLocaleString("id-ID")," (",a.length," sesi)"]}),e.jsxs("p",{className:"text-sm text-green-600",children:["Online: Rp"," ",C.toLocaleString("id-ID")," (",a.length," sesi)"]})]})]}),e.jsxs(u,{size:"lg",onClick:y,className:"flex w-full items-center justify-center text-center sm:w-auto",children:["Lanjutkan Pemesanan",e.jsx(A,{className:"ml-1 h-4 w-4"})]})]})})]})})}export{X as default};
