import{j as e,r as d,L as P,a as L}from"./app-DF9t4bHs.js";import{A as M,a as I,b as O,P as A,d as R}from"./PageLayout-30QWH_SV.js";import{B as j}from"./button-CBeqVokO.js";import{a as p,C as W,b as T,T as B}from"./TimeSlots-C4CT8vpp.js";import{C as E,c as z}from"./card-Dm2AJLrW.js";import{g as K}from"./booking-CORMuwUe.js";import{s as U,f as h}from"./format-DKbtvHO8.js";import{C as F}from"./chevron-left-iW42GP1m.js";import"./index-DW7OYsA0.js";import"./clock-s7RNoK3I.js";function G({counselor:a}){const l=K(a.user.profile_pic);return e.jsx(E,{className:"mb-6",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(M,{className:"h-14 w-14 rounded-lg",children:[e.jsx(I,{src:l,alt:a.user.name}),e.jsx(O,{className:"rounded-lg",children:a.user.name.split(" ").map(c=>c[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-foreground",children:a.user.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Offline: Rp"," ",a.price_per_session.toLocaleString("id-ID")," ","/ Online: Rp"," ",a.online_price_per_session.toLocaleString("id-ID")]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Pilih 1–2 jam konseling yang berdampingan"})]})]})})})}function te({counselor:a}){const[l,c]=d.useState(U(new Date,{weekStartsOn:1})),[o,x]=d.useState(null),[s,m]=d.useState([]),S=Array.from({length:7},(t,i)=>p(l,i)),N=d.useMemo(()=>{const t={};return a.schedules.forEach(i=>{if(i.is_available){const r=h(new Date(i.date),"yyyy-MM-dd");t[r]||(t[r]=[]),t[r].push(i)}}),t},[a.schedules]),u=t=>{const i=h(t,"yyyy-MM-dd");return(N[i]||[]).map(n=>({id:n.id,time:n.start_time.substring(0,5),startTime:n.start_time,endTime:n.end_time,isBooked:!1})).sort((n,f)=>n.time.localeCompare(f.time))},y=(t,i)=>{const[r]=t.split(":").map(Number),[n]=i.split(":").map(Number);return Math.abs(r-n)===1},g=t=>s.length===0?!0:s.length===1?y(s[0].time,t.time):!1,b=()=>{c(p(l,-7)),x(null),m([])},v=()=>{c(p(l,7)),x(null),m([])},w=t=>{x(t),m([])},k=t=>{if(s.some(r=>r.id===t.id))m(s.filter(r=>r.id!==t.id));else if(g(t)){const r=[...s,t].sort((n,f)=>n.time.localeCompare(f.time));m(r)}},C=()=>{if(s.length>0){const t=s.map(i=>i.id).join(",");L.visit(route("client.process.payment",{counselorId:a.id,scheduleIds:t}))}},_=a.price_per_session*s.length,D=a.online_price_per_session*s.length;return e.jsx(A,{children:e.jsxs("div",{className:"mx-auto max-w-3xl",children:[e.jsx(j,{variant:"ghost",asChild:!0,className:"mb-4",children:e.jsxs(P,{href:route("client.counselor.show",a.id),children:[e.jsx(F,{className:"mr-1 h-4 w-4"}),"Kembali ke Profil"]})}),e.jsx(G,{counselor:a}),e.jsx(W,{weekStart:l,onPrevWeek:b,onNextWeek:v}),e.jsx(T,{weekDays:S,selectedDate:o,onSelectDate:w,getAvailableSlots:u}),o&&e.jsx(B,{selectedDate:o,availableSlots:u(o),selectedSlots:s,canSelectSlot:g,onSelectSlot:k}),o&&s.length>0&&e.jsx("div",{className:"animate-slide-up fixed bottom-0 left-0 right-0 z-50 border-t bg-card p-4 shadow-lg",children:e.jsxs("div",{className:"mx-auto flex max-w-3xl flex-col items-start justify-between gap-3 sm:flex-row sm:items-center sm:gap-0",children:[e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Terpilih"}),e.jsxs("p",{className:"font-medium text-foreground",children:[h(o,"d MMM yyyy")," •"," ",s.map(t=>t.time).join(", ")]}),e.jsxs("div",{className:"mt-1 space-y-0.5",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Offline: Rp"," ",_.toLocaleString("id-ID")," (",s.length," sesi)"]}),e.jsxs("p",{className:"text-sm text-green-600",children:["Online: Rp"," ",D.toLocaleString("id-ID")," (",s.length," sesi)"]})]})]}),e.jsxs(j,{size:"lg",onClick:C,className:"flex w-full items-center justify-center text-center sm:w-auto",children:["Lanjutkan Pemesanan",e.jsx(R,{className:"ml-1 h-4 w-4"})]})]})})]})})}export{te as default};
