import{j as e,L as y,r as v,a as A}from"./app-OwMnVvoM.js";import{c as C,g as M,C as h,h as b,u as K,A as L,a as T,b as P,P as $}from"./PageLayout-risw4cSB.js";import{C as r,c as l,B as d,a as w,b as _}from"./card-cyydU77a.js";import{B as k}from"./badge-Un45IRAM.js";import{C as N}from"./clock-BT0qfSJI.js";import{C as R}from"./circle-alert-B-vzthde.js";import{S as g}from"./separator-D6aDwszA.js";import{f as E}from"./format-DKbtvHO8.js";import{C as I}from"./credit-card-B7ioX-_-.js";import{i as U}from"./id-BLZN8RMz.js";import{C as z}from"./chevron-left-CIvaKKEN.js";import"./index-AU5kxg5P.js";const J=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],F=C("copy",J);const q=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],H=C("external-link",q);function V({booking:s}){const{toast:a}=K(),[n,u]=v.useState(!1),x=()=>{navigator.clipboard.writeText(s.payment?.payment_url??""),u(!0),a({title:"Link disalin",description:"Link pembayaran berhasil disalin ke clipboard"}),setTimeout(()=>u(!1),2e3)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(r,{className:"border-warning/30 bg-warning/5",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3 w-full",children:[e.jsx(R,{className:"h-5 w-5 text-warning mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[" ",e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Menunggu Pembayaran"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3 break-words",children:"Silakan selesaikan pembayaran untuk mengonfirmasi booking Anda. Booking akan otomatis dibatalkan jika pembayaran tidak diselesaikan dalam 15 menit."}),e.jsxs("div",{className:"flex items-center gap-2 mb-3 w-full",children:[e.jsx("div",{className:`flex-1 bg-background rounded-lg p-3 text-sm font-mono
                    text-muted-foreground truncate max-w-full overflow-hidden`,children:s.payment?.payment_url}),e.jsx(d,{variant:"outline",size:"icon",onClick:x,children:n?e.jsx(b,{className:"h-4 w-4 text-success"}):e.jsx(F,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"icon",asChild:!0,children:e.jsx("a",{href:s.payment?.payment_url??"",target:"_blank",rel:"noopener noreferrer",children:e.jsx(H,{className:"h-4 w-4"})})})]})]})]})})}),e.jsx("div",{className:"space-y-2",children:e.jsx(d,{className:"w-full",size:"lg",variant:"default",asChild:!0,children:e.jsx("a",{href:s.payment?.payment_url??"",target:"_blank",rel:"noopener noreferrer",children:"Bayar Sekarang"})})})]})}function W({booking:s}){const a=s.status==="paid"&&!s.is_expired&&s.reschedule_status==="none",x=new Date(s.schedule.date)<new Date,o=i=>i.charAt(0).toUpperCase()+i.slice(1);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(r,{className:"border-success/30 bg-success/5",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(b,{className:"h-5 w-5 text-success mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Pembayaran Berhasil"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Booking Anda telah dikonfirmasi. Silahkan datang sesuai jadwal yang telah dipesan."})]})]})})}),s.reschedule_status!=="none"&&e.jsx(r,{className:"border-primary/20 bg-primary/5",children:e.jsxs(l,{className:"p-4 space-y-3",children:[e.jsx("h4",{className:"font-semibold text-foreground",children:"Status Reschedule"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold
                ${s.reschedule_status==="pending"?"bg-yellow-100 text-yellow-800":s.reschedule_status==="approved"?"bg-green-100 text-green-800":s.reschedule_status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-700"}`,children:o(s.reschedule_status??"")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Diminta oleh"}),e.jsx("span",{className:"font-medium",children:s.reschedule_by?o(s.reschedule_by):"-"})]}),s.reschedule_reason&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:"Alasan Reschedule"}),e.jsx("p",{className:"text-sm font-medium mt-1",children:s.reschedule_reason})]}),s.reschedule_status==="pending"&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 p-3 rounded-md text-xs",children:"Permintaan reschedule sedang menunggu persetujuan konselor."}),s.reschedule_status==="approved"&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 p-3 rounded-md text-xs",children:"Reschedule disetujui. Silakan cek jadwal terbaru Anda."}),s.reschedule_status==="rejected"&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 p-3 rounded-md text-xs",children:"Reschedule ditolak. Jadwal tetap menggunakan sesi sebelumnya."})]})}),a&&e.jsx(r,{className:"border-primary/20 bg-primary/5",children:e.jsx(l,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:e.jsx(h,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Perlu Mengubah Jadwal?"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Anda dapat melakukan reschedule sesi konseling ini jika ada perubahan jadwal."}),e.jsx(d,{asChild:!0,children:e.jsxs(y,{href:route("client.pick.reschedule",s.id),children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Reschedule Booking"]})})]})]})})}),s.consultation_type==="online"&&e.jsx(e.Fragment,{children:s.meeting_link?e.jsx(r,{className:"border-primary/30 bg-primary/5",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(h,{className:"h-5 w-5 text-primary mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Link Konsultasi Tersedia"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Link meeting sudah siap. Anda dapat masuk ke ruang konsultasi sekarang."}),e.jsx(d,{className:"w-full",asChild:!0,children:e.jsx("a",{href:s.meeting_link,target:"_blank",rel:"noopener noreferrer",children:"Masuk ke Sesi Konsultasi"})})]})]})})}):!x&&e.jsx(r,{className:"border-muted",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(N,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Menunggu Link Meeting"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Konselor akan mengirimkan link sebelum sesi dimulai."})]})]})})})})]})}function X({booking:s}){const a=s.cancelled_by==="client"?"Dibatalkan oleh Anda":s.cancelled_by==="counselor"?"Dibatalkan oleh Konselor":s.cancelled_by==="admin"?"Dibatalkan oleh Admin":"Dibatalkan oleh Sistem";return e.jsx("div",{className:"space-y-4",children:e.jsx(r,{className:"border-destructive/30 bg-destructive/5",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(M,{className:"h-5 w-5 text-destructive mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Booking Dibatalkan"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a}),s.cancel_reason&&e.jsxs("p",{className:"text-sm text-muted-foreground italic bg-background p-2 rounded-lg",children:["Alasan: ",s.cancel_reason]}),s.payment?.status==="refund"&&e.jsx("p",{className:"text-sm text-blue-600 mt-3",children:"Dana sedang dalam proses pengembalian (refund)."}),s.payment?.status==="refunded"&&e.jsx("p",{className:"text-sm text-green-600 mt-3 font-medium",children:"Dana telah berhasil dikembalikan."})]})]})})})})}function G({booking:s}){return e.jsx("div",{className:"space-y-4",children:e.jsx(r,{className:"border-orange-300 bg-orange-50",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(N,{className:"h-5 w-5 text-orange-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Pembayaran Kadaluarsa"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Waktu pembayaran telah berakhir. Booking dibatalkan otomatis oleh sistem."}),s.cancel_reason&&e.jsxs("p",{className:"text-sm italic text-muted-foreground bg-background p-2 rounded-lg",children:["Alasan: ",s.cancel_reason]})]})]})})})})}function O({booking:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(r,{className:"border-primary/30 bg-primary/5",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(b,{className:"h-5 w-5 text-primary mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Sesi Konsultasi Selesai"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Terima kasih telah menggunakan layanan kami. Kami harap sesi konsultasi bermanfaat untuk Anda."})]})]})})}),s.counselor_notes&&e.jsxs(r,{className:"border-border bg-background",children:[e.jsx(w,{children:e.jsx(_,{className:"text-lg",children:"Catatan Konselor"})}),e.jsx(l,{children:e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed whitespace-pre-line",children:s.counselor_notes})})]})]})}function Q({booking:s}){const a=s.previous_schedule,n=s.previous_second_schedule;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(r,{className:"border-warning/30 bg-warning/5",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(h,{className:"h-5 w-5 text-warning mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground mb-1",children:"Jadwal Diubah"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Booking ini telah dijadwalkan ulang. (Perubahan jadwal masih menunggu persetujuan Konselor)"}),a&&e.jsxs("div",{className:"bg-background rounded-lg p-3 text-sm space-y-1 border",children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Jadwal Sebelumnya:"}),e.jsx("p",{className:"font-medium text-foreground",children:a.date}),e.jsxs("p",{className:"text-muted-foreground",children:[a.start_time.substring(0,5)," -"," ",a.end_time.substring(0,5)]}),n&&e.jsxs("p",{className:"text-muted-foreground",children:["& ",n.start_time.substring(0,5)," -"," ",n.end_time.substring(0,5)]})]})]})]})})}),s.meeting_link&&e.jsx(d,{className:"w-full",size:"lg",asChild:!0,children:e.jsx("a",{href:s.meeting_link,target:"_blank",rel:"noopener noreferrer",children:"Masuk ke Sesi Konsultasi"})})]})}function Y({booking:s}){const n=s.counselor.user.profile_pic?`http://127.0.0.1:8000/storage/${s.counselor.user.profile_pic}`:"/default-avatar.png",u=new Date(s.schedule.date),x=s.schedule.start_time.substring(0,5),o=s.second_schedule?.end_time?.substring(0,5)||s.schedule.end_time.substring(0,5),i=`${x} - ${o}`,p=s.payment?.amount??0,j=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),m=t=>t.replace(/_/g," ").split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1)).join(" ");return e.jsxs(r,{className:"mb-6",children:[e.jsx(w,{className:"pb-4",children:e.jsxs(_,{className:"text-lg",children:["Invoice #",s.payment?.order_id]})}),e.jsxs(l,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[e.jsxs(L,{className:"h-16 w-16 rounded-lg mx-auto sm:mx-0",children:[e.jsx(T,{src:n,alt:s.counselor.user.name}),e.jsx(P,{className:"rounded-lg",children:s.counselor.user.name.split(" ").map(t=>t[0]).join("")})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"font-semibold text-foreground text-lg",children:s.counselor.user.name}),e.jsx("div",{className:"flex flex-wrap justify-center sm:justify-start gap-1 mt-1",children:s.counselor.specialization?.split(",").map((t,c)=>e.jsx(k,{variant:"secondary",className:"text-xs",children:t.trim()},c))})]})]}),e.jsx(g,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(f,{icon:e.jsx(h,{className:"h-4 w-4"}),label:"Tanggal",value:E(u,"EEEE, d MMMM yyyy",{locale:U})}),e.jsx(f,{icon:e.jsx(N,{className:"h-4 w-4"}),label:"Waktu",value:i}),e.jsx(f,{icon:e.jsx(N,{className:"h-4 w-4"}),label:"Durasi",value:`${s.duration_hours} jam`}),e.jsx(f,{icon:e.jsx(I,{className:"h-4 w-4"}),label:"Metode Pembayaran",value:m(s.payment?.payment_type??"Belum")}),e.jsx(f,{icon:e.jsx(h,{className:"h-4 w-4"}),label:"Jenis Konsultasi",value:s.consultation_type})]}),e.jsx(g,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Biaya Sesi"}),e.jsx("span",{children:j(s.price)})]}),e.jsx(g,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Total"}),e.jsx("span",{className:"text-xl font-semibold",children:j(p)})]})]})]})]})}function f({icon:s,label:a,value:n}){return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s,e.jsx("span",{children:a})]}),e.jsx("span",{className:"font-medium text-foreground break-words",children:n})]})}function ue({booking:s}){s.counselor.user.profile_pic&&`http://127.0.0.1:8000${s.counselor.user.profile_pic}`;const n=m=>({pending_payment:"warning",paid:"success",completed:"default",cancelled:"destructive",rescheduled:"secondary"})[m]||"secondary",u=m=>m.replace(/_/g," ").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),x=()=>{if(s.is_expired)return e.jsx(G,{booking:s});if(s.status==="cancelled")return e.jsx(X,{booking:s});switch(s.status){case"pending_payment":return e.jsx(V,{booking:s});case"paid":return e.jsx(W,{booking:s});case"completed":return e.jsx(O,{booking:s});case"rescheduled":return e.jsx(Q,{booking:s});default:return null}},o=()=>{confirm("Anda yakin ingin membatalkan booking ini?")&&A.post(route("client.cancel.booking",s.id),{reason:"Dibatalkan oleh client"},{preserveScroll:!0})},i=s.payment?.expiry_time?new Date(s.payment.expiry_time):null,[p,j]=v.useState(null);return v.useEffect(()=>{if(!i)return;const m=setInterval(()=>{const t=new Date().getTime(),c=i.getTime()-t;if(c<=0){j("Kadaluarsa"),clearInterval(m);return}const S=Math.floor(c/(1e3*60*60)),D=Math.floor(c%(1e3*60*60)/(1e3*60)),B=Math.floor(c%(1e3*60)/1e3);j(`${S}j ${D}m ${B}d`)},1e3);return()=>clearInterval(m)},[i]),e.jsx($,{children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsx(d,{variant:"ghost",asChild:!0,className:"mb-4",children:e.jsxs(y,{href:route("client.booking.history"),children:[e.jsx(z,{className:"h-4 w-4 mr-1"}),"Kembali ke Daftar Booking"]})}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"font-display text-2xl font-semibold text-foreground",children:"Detail Booking"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{variant:n(s.status),className:"text-sm",children:u(s.status)}),p&&!s.is_expired&&s.status=="pending_payment"&&e.jsx("div",{className:"px-3 py-1 rounded-md bg-red-50 border border-red-200 text-red-600 text-xs font-medium",children:p==="Kadaluarsa"?"Kadaluarsa":`Sisa waktu: ${p}`}),["paid","rescheduled"].includes(s.status)&&!s.is_expired&&e.jsx(d,{variant:"destructive",size:"sm",onClick:()=>o(),children:"Cancel Booking"})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(Y,{booking:s})}),e.jsxs("div",{className:"h-fit",children:[x(),s.notes&&e.jsxs(r,{className:"my-3",children:[e.jsx(w,{children:e.jsx(_,{className:"text-lg",children:"Catatan Klien"})}),e.jsx(l,{children:e.jsx("p",{className:"text-muted-foreground",children:s.notes})})]}),e.jsx(d,{variant:"outline",className:"w-full my-2 transition hover:bg-primary hover:border-white hover:text-white",asChild:!0,children:e.jsx(y,{href:route("client.booking.history"),children:"Lihat Semua Booking"})})]})]})})]})})}export{ue as default};
