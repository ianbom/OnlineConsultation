import{j as e,r as c,L as k,a as _}from"./app-XQMMahi2.js";import{A as D,a as P,b as A,P as L,d as M}from"./PageLayout-COyCGqVq.js";import{B as h}from"./button-B4ntXuXE.js";import{a as f,C as I,b as T,T as B}from"./TimeSlots-CgqeFVOT.js";import{C as R,c as W}from"./card-CwtlR_4T.js";import{s as E,f as j}from"./format-DKbtvHO8.js";import{C as z}from"./chevron-left-DHenVtRw.js";import"./index-CCLk4ADv.js";import"./clock-Cx5WORcs.js";function K({counselor:s}){const o=s.user.profile_pic?`/storage/${s.user.profile_pic}`:null;return e.jsx(R,{className:"mb-6",children:e.jsx(W,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(D,{className:"h-14 w-14 rounded-lg",children:[e.jsx(P,{src:o||void 0,alt:s.user.name}),e.jsx(A,{className:"rounded-lg",children:s.user.name.split(" ").map(m=>m[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-foreground",children:s.user.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Rp"," ",s.price_per_session.toLocaleString("id-ID")," ","per sesi"]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Pilih 1–2 jam konseling yang berdampingan"})]})]})})})}function V({counselor:s}){const[o,m]=c.useState(E(new Date,{weekStartsOn:1})),[n,g]=c.useState(null),[a,d]=c.useState([]),S=Array.from({length:7},(t,r)=>f(o,r)),N=c.useMemo(()=>{const t={};return s.schedules.forEach(r=>{if(r.is_available===1){const i=r.date;t[i]||(t[i]=[]),t[i].push(r)}}),t},[s.schedules]),p=t=>{const r=j(t,"yyyy-MM-dd");return(N[r]||[]).map(l=>({id:l.id,time:l.start_time.substring(0,5),startTime:l.start_time,endTime:l.end_time,isBooked:!1})).sort((l,x)=>l.time.localeCompare(x.time))},b=(t,r)=>{const[i]=t.split(":").map(Number),[l]=r.split(":").map(Number);return Math.abs(i-l)===1},u=t=>a.length===0?!0:a.length===1?b(a[0].time,t.time):!1,v=t=>{g(t),d([])},w=t=>{if(a.some(i=>i.id===t.id))d(a.filter(i=>i.id!==t.id));else if(u(t)){const i=[...a,t].sort((l,x)=>l.time.localeCompare(x.time));d(i)}},y=()=>{if(a.length>0){const t=a.map(r=>r.id).join(",");_.visit(route("client.process.payment",{counselorId:s.id,scheduleIds:t}))}};n&&p(n),s.user.profile_pic&&`${s.user.profile_pic}`;const C=s.price_per_session*a.length;return e.jsx(L,{children:e.jsxs("div",{className:"mx-auto max-w-3xl",children:[e.jsx(h,{variant:"ghost",asChild:!0,className:"mb-4",children:e.jsxs(k,{href:route("client.counselor.show",s.id),children:[e.jsx(z,{className:"mr-1 h-4 w-4"}),"Kembali ke Profil"]})}),e.jsx(K,{counselor:s}),e.jsx(I,{weekStart:o,onPrevWeek:()=>m(f(o,-7)),onNextWeek:()=>m(f(o,7))}),e.jsx(T,{weekDays:S,selectedDate:n,onSelectDate:v,getAvailableSlots:p}),n&&e.jsx(B,{selectedDate:n,availableSlots:p(n),selectedSlots:a,canSelectSlot:u,onSelectSlot:w}),n&&a.length>0&&e.jsx("div",{className:"animate-slide-up fixed bottom-0 left-0 right-0 z-50 border-t bg-card p-4 shadow-lg",children:e.jsxs("div",{className:"mx-auto flex max-w-3xl flex-col items-start justify-between gap-3 sm:flex-row sm:items-center sm:gap-0",children:[e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Terpilih"}),e.jsxs("p",{className:"font-medium text-foreground",children:[j(n,"d MMM yyyy")," •"," ",a.map(t=>t.time).join(", ")]}),e.jsxs("p",{className:"mt-1 text-sm text-muted-foreground",children:["Total: Rp"," ",C.toLocaleString("id-ID")," (",a.length," sesi)"]})]}),e.jsxs(h,{size:"lg",onClick:y,className:"flex w-full items-center justify-center text-center sm:w-auto",children:["Lanjutkan Pemesanan",e.jsx(M,{className:"ml-1 h-4 w-4"})]})]})})]})})}export{V as default};
